---
title: 树莓派上配置动态域名解析Oray DDNS
abbrlink: 58597cbe
date: 2015-09-12 21:45:53
tags:
category:
---
raspberry pi玩到后来不可避免会玩上DDNS，即[动态域名解析](https://en.wikipedia.org/wiki/Dynamic_DNS)，众所周知拨号上网拿到的公网IP每次可能不一样，为了从公网访问拨号猫后面的内网PC，需要外部提供一个查询机制，即DDNS，在这个外部查询系统注册一个域名之后，内部再装一个客户端，里应外合，把拨号拿到的公网IP通知给公网上的查询系统。这样公网用户每次要访问内网的PC，首先到这个确定地址的公网查询注册的域名，然后转换成对应的IP，从而达到访问内网PC的目的。
关于如何在Raspberry Pi设置花生壳，官网已经有[介绍](http://service.oray.com/question/2680.html)。
需要注意的是运行oraynewph需要root权限。

**Update@2015-09-13**
花生壳的免费域名实在太不好用，第一次成功更新A记录后，不管后面拨号再怎么重换地址，花生壳系统的A记录和路由的WAN地址始终不一致，还不能手动改。考虑到使用的电信网络，应该不存在ISP NAT的情况，折腾数天不妥，怒弃之。。。
![死活不更新](/img/2015-09-13_174117.png)
另外考虑到花生壳的免费域名，可能会被无聊人士盯上乱扫描，万一自家的路由器，树莓派等等有什么漏洞，城池难保。~~折衷的办法就是自己麻烦一点，让rapsberry pi主动email报告IP。后面完善了回来补充~~。鉴于ISP NAT的问题，WAN的IP也不是公网IP，这个方案也被否决了。
**Update@2015-09-14**
换了路由自带的花生壳客户端，同样的不一致问题，~~只能归咎于免费域名的故意限制。。。尝试其他DDNS服务。。。~~
**Update@2015-09-14**
3322也一样，ip138也显示这个地址，看来真的是有ISP NAT。。。
**Update@2015-09-15**
对于ISP NAT，花生壳官网介绍有[解决方案](http://service.oray.com/question/136.html)，只要你升到专业服务:(
说实话这个解决方案只是重新选择了下接入线路，背后原理莫名其妙，貌似再没有其它家有类似的解决方案。
初步搜索了下，在有ISP NAT的情况下，如果自己用，VPN不失为一个靠谱的解决方案。
