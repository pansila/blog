<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.6" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.6">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.6" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.6',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Fantasy and Fiction">
<meta property="og:url" content="http://pansila.github.io/index.html">
<meta property="og:site_name" content="Fantasy and Fiction">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fantasy and Fiction">






  <link rel="canonical" href="http://pansila.github.io/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Fantasy and Fiction</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fantasy and Fiction</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
</li>

      

      
    </ul>
  

  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2018/03/22/2018-03-22-ubuntu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/22/2018-03-22-ubuntu/" itemprop="url">Install multi-version cross-compile toolchain on ubuntu</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-22T21:28:40+08:00">2018-03-22</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/03/22/2018-03-22-ubuntu/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/03/22/2018-03-22-ubuntu/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>As of ubuntu 17.10, apt source has provided us several cross-compile toolchains for the ARM platform:</p>
<ul>
<li>gcc-5-arm-linux-gnueabihf</li>
<li>gcc-6-arm-linux-gnueabihf</li>
<li>gcc-7-arm-linux-gnueabihf</li>
<li>…</li>
</ul>
<p>After getting them installed, these tools got a suffix number to indicate the version, like  <code>/usr/bin/arm-linux-gnueabihf-gcc-5</code>.</p>
<p>We’d like to specify which one to use as per the project requirement.</p>
<p>Fortunately we can make it easily by using the tool <code>update-alternatives</code> which comes with the ubuntu distribution.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo update-alternatives --install /usr/bin/arm-linux-gnueabihf-gcc arm-linux-gnueabihf-gcc /usr/bin/arm-linux-gnueabihf-gcc-5 100 --slave /usr/bin/arm-linux-gnueabihf-g++ arm-linux-gnueabihf-g++ /usr/bin/arm-linux-gnueabihf-g++-5</span><br></pre></td></tr></table></figure>
<p>Here, we have provided the <code>arm-linux-gnueabihf-gcc</code> as the master and <code>arm-linux-gnueabihf-g++</code> as slave. Multiple slaves can be appended along with master. When master symbolic link is changed, the slaves will be changed too.</p>
<p>Pass the second version of these tools to be recorded:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo update-alternatives --install /usr/bin/arm-linux-gnueabihf-gcc arm-linux-gnueabihf-gcc /usr/bin/arm-linux-gnueabihf-gcc-6 50 --slave /usr/bin/arm-linux-gnueabihf-g++ arm-linux-gnueabihf-g++ /usr/bin/arm-linux-gnueabihf-g++-6</span><br></pre></td></tr></table></figure></p>
<p>Now you can switch between these versions by using:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo update-alternatives --config arm-linux-gnueabihf-gcc</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2018/02/02/2018-02-02-flv.js-demo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/02/2018-02-02-flv.js-demo/" itemprop="url">一个flv.js简单demo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-02-02T17:02:06+08:00">2018-02-02</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/02/02/2018-02-02-flv.js-demo/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2018/02/02/2018-02-02-flv.js-demo/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.jianshu.com/p/d9c66d7d1653" target="_blank" rel="noopener">参考demo</a></p>
<ol>
<li><p>启动web server</p>
<p>通常我们需要安装apache或者nginx，这里只需要一个简单的静态server就够了，因为flv的解析都在浏览器前端。</p>
<ul>
<li>python 2</li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">python -m SimpleHTTPServer</span></span><br></pre></td></tr></table></figure>
<ul>
<li>python 3</li>
</ul>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">py -m http.<span class="keyword">server</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>把文后的js源文件放到web server根目录</p>
</li>
<li><p>浏览器打开默认的server地址，localhost:8000</p>
<p>这个时候还看不到视频内容，因为媒体文件还没有</p>
</li>
<li><p>用ffmpeg制作一个flv文件</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f gdigrab -framerate <span class="number">10</span> -<span class="selector-tag">i</span> desktop -vcodec h264 -acodec aac -f flv movie.flv</span><br></pre></td></tr></table></figure>
<p>这里是在录制屏幕并输出到movie.flv，注意要选择编码器，默认的编码flv.js并不支持，然后也放到根目录</p>
<p>默认编码器</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">encoder</span>         : <span class="selector-tag">Lavc57</span><span class="selector-class">.107</span><span class="selector-class">.100</span> <span class="selector-tag">flv</span></span><br></pre></td></tr></table></figure>
<p>指定后</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">encoder</span>         : <span class="selector-tag">Lavc57</span><span class="selector-class">.107</span><span class="selector-class">.100</span> <span class="selector-tag">libx264</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>最后再刷新主页，可以播放视频了</p>
</li>
</ol>
<p><img src="img/2018-02-02_173013.png" alt=""></p>
<hr>
<p>js源文件<br><div><div class="fold_hider"><div class="close hider_title">点击显/隐内容</div></div><div class="fold">
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta content=<span class="string">"text/html; charset=utf-8"</span> http-equiv=<span class="string">"Content-Type"</span>&gt;</span><br><span class="line">    &lt;title&gt;flv.js demo&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;style&gt;</span></span><br><span class="line"><span class="regexp">        .mainContainer &#123;</span></span><br><span class="line"><span class="regexp">            display: block;</span></span><br><span class="line"><span class="regexp">            width: 1024px;</span></span><br><span class="line"><span class="regexp">            margin-left: auto;</span></span><br><span class="line"><span class="regexp">            margin-right: auto;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        .urlInput &#123;</span></span><br><span class="line"><span class="regexp">            display: block;</span></span><br><span class="line"><span class="regexp">            width: 100%;</span></span><br><span class="line"><span class="regexp">            margin-left: auto;</span></span><br><span class="line"><span class="regexp">            margin-right: auto;</span></span><br><span class="line"><span class="regexp">            margin-top: 8px;</span></span><br><span class="line"><span class="regexp">            margin-bottom: 8px;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        .centeredVideo &#123;</span></span><br><span class="line"><span class="regexp">            display: block;</span></span><br><span class="line"><span class="regexp">            width: 100%;</span></span><br><span class="line"><span class="regexp">            height: 576px;</span></span><br><span class="line"><span class="regexp">            margin-left: auto;</span></span><br><span class="line"><span class="regexp">            margin-right: auto;</span></span><br><span class="line"><span class="regexp">            margin-bottom: auto;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        .controls &#123;</span></span><br><span class="line"><span class="regexp">            display: block;</span></span><br><span class="line"><span class="regexp">            width: 100%;</span></span><br><span class="line"><span class="regexp">            text-align: left;</span></span><br><span class="line"><span class="regexp">            margin-left: auto;</span></span><br><span class="line"><span class="regexp">            margin-right: auto;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>style&gt;</span><br><span class="line">&lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div class="mainContainer"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;video id="videoElement" class="centeredVideo" controls autoplay width="1024" height="576"&gt;Your browser is too old which doesn't support HTML5 video.&lt;/</span>video&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;br&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div class="controls"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;!--&lt;button onclick="flv_load()"&gt;加载&lt;/</span>button&gt;--&gt;</span><br><span class="line">        &lt;button onclick=<span class="string">"flv_start()"</span>&gt;开始&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;button onclick="flv_pause()"&gt;暂停&lt;/</span>button&gt;</span><br><span class="line">        &lt;button onclick=<span class="string">"flv_destroy()"</span>&gt;停止&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input style="width:100px" type="text" name="seekpoint" /</span>&gt;</span><br><span class="line">        &lt;button onclick=<span class="string">"flv_seekto()"</span>&gt;跳转&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">    &lt;script src=<span class="string">"https://cdn.bootcss.com/flv.js/1.4.0/flv.min.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="keyword">var</span> player = <span class="built_in">document</span>.getElementById(<span class="string">'videoElement'</span>);</span><br><span class="line">        <span class="keyword">if</span> (flvjs.isSupported()) &#123;</span><br><span class="line">            <span class="keyword">var</span> flvPlayer = flvjs.createPlayer(&#123;</span><br><span class="line">                type: <span class="string">'flv'</span>,</span><br><span class="line">                <span class="string">"isLive"</span>: <span class="literal">true</span>,<span class="comment">//&lt;====加个这个</span></span><br><span class="line">                url: <span class="string">'movie.flv'</span>,<span class="comment">//&lt;==自行修改</span></span><br><span class="line"></span><br><span class="line">            &#125;);</span><br><span class="line">            flvPlayer.attachMediaElement(videoElement);</span><br><span class="line">            flvPlayer.load(); <span class="comment">//加载</span></span><br><span class="line">            flv_start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">flv_start</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            player.play();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">flv_pause</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            player.pause();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">flv_destroy</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            player.pause();</span><br><span class="line">            player.unload();</span><br><span class="line">            player.detachMediaElement();</span><br><span class="line">            player.destroy();</span><br><span class="line">            player = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">flv_seekto</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            player.currentTime = <span class="built_in">parseFloat</span>(<span class="built_in">document</span>.getElementsByName(<span class="string">'seekpoint'</span>)[<span class="number">0</span>].value);</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure>

</div></div></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2017/07/29/2017/2017-07-29-a-weird-serial-port-issue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/29/2017/2017-07-29-a-weird-serial-port-issue/" itemprop="url">一个诡异的232串口故障</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-29T21:59:04+08:00">2017-07-29</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/29/2017/2017-07-29-a-weird-serial-port-issue/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2017/07/29/2017/2017-07-29-a-weird-serial-port-issue/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前段时间收到一块LED显示屏的通讯电路板，有很明显的串口通讯问题，表现就是无收发数据，显示屏无显示，量测TX和RX上也的确没有电平变化。<br><img src="/img/2017-07-29_222557.png" alt="MAX3232电路图"><br>尝试替换MAX3232芯片后，问题依旧，因为以前吃过亏，怀疑买到假货，又替换SP3232，还是趴窝，苦思不得其解，买假货买到怀疑人生。。。<br>过了几天重新制作一批板子，同样的232芯片居然是正常工作的，才反应过来可能是配套电容有问题。回过头又重新观察232串口电路，拿示波器依次量测几颗电容两端的电压，对比正常板子，发现问题板子这几个点位信号幅度大约只有正常板子的一半，但电容两端的信号仍然保持反向对称，只有pin 1和pin 3之间的这颗电容两端，不仅幅度减半，pin 3的信号异常低，只有大约300mV的幅度，遂替换之，问题立马消失。<br>那么这颗电容到底有什么问题呢，上图<br><img src="/img/2017-07-29_222222.jpg" alt="罪魁祸首"><br>大概是某小作坊良心之作，一端的焊盘直接脱落了。。。WTF</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2016/12/25/2016/2016-12-25-database-synchronization-with-kettle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/25/2016/2016-12-25-database-synchronization-with-kettle/" itemprop="url">ETL利器Kettle数据库同步实战</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-25T18:19:36+08:00">2016-12-25</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/25/2016/2016-12-25-database-synchronization-with-kettle/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2016/12/25/2016/2016-12-25-database-synchronization-with-kettle/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近有需求在SQL server和MySQL之间数据库同步，在比较多种方案后选择了Kettle，因其开源免费，用户多文档完善，图形化编辑上手容易。这里使用了其最新版本，Pentaho Data Integration 7.0。</p>
<p>具体需求不复杂，要从MySQL数据库一张表定期更新到SQL server数据库。这里面数据库之间的差异，Kettle已经通过SQL语言抽象，所以只要处理表结构的差异和转换，主要是数据类型的转换和值映射。这些转换都使用了<code>Script Values / Mod</code>模块处理。而类型和值都匹配仅字段名不同的转换，可以直接在<code>Insert / Update</code>模块里面映射。</p>
<p>为了便于后续调试，为远程MySQL数据库做了一个本地映射，这里用到了合并模块<code>Merge Rows (diff)</code>和同步模块<code>Synchronize after merge</code>。</p>
<p>首先为这三个数据分别建立连接。从左边设计面板拖出一个表输入模块<code>Table input</code>。<br><img src="/img/2016-12-25_203233.png" alt="Table input"></p>
<p>点击New按钮，为数据库连接配置参数。配置好后可以点下面的Test按钮，测试配置是否正确。为本地备份数据库也如此建立连接。<br><img src="/img/2016-12-25_203404.png" alt="Edit connection for MySQL"><br>这是SQL Server数据库的连接配置。<br><img src="/img/2016-12-25_203821.png" alt="Edit connection for SQL server"><br>注意从官网下载的Kettle缺少这两个数据库的驱动文件。分别是<code>jtds-1.3.1.jar</code>和<code>mysql-connector-java-5.1.40-bin.jar</code>。放到kettle的lib目录下即可。</p>
<p>然后建立远端数据库到本地数据库的映射，同样从左边面板拖出来<code>Merge Rows (diff)</code>，这个模块根据若干Key来检索两边数据，然后根据选定的若干Value来检查数据是否一致，哪边的数据较新，哪边的过时。<br><img src="/img/2016-12-25_202709.png" alt="Merge Rows (diff)"><br>注意这里的<code>Flag fieldname</code>字段，它会作为输出之一送到后续模块，后面会看到它的作用。</p>
<p>接着放上同步模块<code>Synchronize after merge</code>，这里有个坑，可以看到General页旁边还有个Advanced页面，一般这种并排折叠的tab页都是些高级配置，不配置默认就不起作用。然而这里不是，它不配置就无法正常工作。<br><img src="/img/2016-12-25_204752.png" alt="Synchronize after merge"><br><img src="/img/2016-12-25_205129.png" alt="Synchronize after merge Advanced"><br>这是配置后的样子，可以看到前面的flagfield字段的作用，它会保存前面Merge模块的比较结果，有三个值<code>new</code>，<code>changed</code>和<code>deleted</code>，意思是对照远程参考数据库，正在检索的数据是否是新添加的，是否是已经有的数据但是需要更新的，是否是过时的数据需要删除的。</p>
<p>接着来到<code>Script Values / Mod</code>模块，这是整个任务的重点，<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类型映射，datetime to string可以方便地用内置的JS函数库date2str来完成</span></span><br><span class="line">i_FStartDate = date2str(WRITE_DATE, <span class="string">"yyyy-mm-dd hh:mm:ss"</span>);</span><br><span class="line">i_FCreateDate = i_FStartDate;</span><br><span class="line"><span class="keyword">var</span> d1 = str2date(i_FStartDate, <span class="string">"yyyy-mm-dd hh:mm:ss"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 值映射</span></span><br><span class="line"><span class="keyword">switch</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> (PASS_TYPE.equals(<span class="string">"员工车辆"</span>)):</span><br><span class="line">  <span class="comment">// 还可以对数据做一些计算后转换</span></span><br><span class="line">	i_FEndDate = dateAdd(d1, <span class="string">"y"</span>, year(VALID_DATE));</span><br><span class="line">	i_FEndDate = date2str(i_FEndDate, <span class="string">"yyyy-mm-dd hh:mm:ss"</span>);</span><br><span class="line">	i_FCardTypeID = <span class="number">1010</span>;</span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> (PASS_TYPE.equals(<span class="string">"客户车辆"</span>)):</span><br><span class="line">	i_FEndDate = dateAdd(d1, <span class="string">"y"</span>, year(VALID_DATE));</span><br><span class="line">	i_FEndDate = date2str(i_FEndDate, <span class="string">"yyyy-mm-dd hh:mm:ss"</span>);</span><br><span class="line">	i_FCardTypeID = <span class="number">1020</span>;</span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> (PASS_TYPE.equals(<span class="string">"作业车辆"</span>)):</span><br><span class="line">	i_FEndDate = dateAdd(d1, <span class="string">"y"</span>, year(VALID_DATE));</span><br><span class="line">	i_FEndDate = date2str(i_FEndDate, <span class="string">"yyyy-mm-dd hh:mm:ss"</span>);</span><br><span class="line">	i_FCardTypeID = <span class="number">1030</span>;</span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">	i_FEndDate = dateAdd(d1, <span class="string">"y"</span>, year(VALID_DATE));</span><br><span class="line">	i_FEndDate = date2str(i_FEndDate, <span class="string">"yyyy-mm-dd hh:mm:ss"</span>);</span><br><span class="line">	i_FCardTypeID = <span class="number">1020</span>;</span><br><span class="line">	<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>datetime to string可以方便地用内置的JS函数库date2str来完成，甚至进而可以对数据做一些计算，这里体现了用javascript转换的灵活性，这在<code>Insert / Update</code>是不可能的。 注意转换后的字段，在javascript可以当成普通变量赋值，只要在下面的Fields里面声明过。<br><img src="/img/2016-12-25_210515.png" alt="Script Values / Mod"></p>
<p>最后将处理好的字段和可以直接映射的字段，在<code>Insert /Update</code>里面做好一一映射。这里也有个新手坑，根据look up keys检索不到的数据会被insert到目标数据库，检索到的数据会接着去比较下面的Update fields映射表，值不同的字段会接着去Update，除非后面Update字段指定了N。然而对于没有在Update fields表里出现的字段，该模块即不会去insert也不会去update。这点区别很重要，因为一般数据表都会有一个主键，这个键是不能重复的，如果insert或update时包含了这个字段，会报错该字段无法更新。所以不要把主键或者Identity属性字段放到Update fields里面，让数据库内部自动分配主键，这也适用于其它自动过程控制的字段。<br><img src="/img/2016-12-25_210645.png" alt="Insert / Update"></p>
<p>这样就得到了最终的转换方案。<br><img src="/img/2016-12-25_200159.png" alt="Final solution"></p>
<p>为了定期运行这个转换任务(Transformation)，还要建立Kettle里面的Job任务，也很简单，新建一个job，拖出start模块。设置运行间隔。<br><img src="/img/2016-12-25_213058.png" alt="Job Scheduling"><br>然后拖出Transformation模块，指定之前配置的转换任务文件路径。<br><img src="/img/2016-12-25_213327.png" alt="Transformation"><br>连接两个模块，搞定。<br><img src="/img/2016-12-25_213426.png" alt="Job"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2016/12/24/2016/2016-12-24-move-OS-to-the-new-disk-without-reinstalling/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/24/2016/2016-12-24-move-OS-to-the-new-disk-without-reinstalling/" itemprop="url">不重装迁移系统到新磁盘</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-24T15:03:36+08:00">2016-12-24</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/24/2016/2016-12-24-move-OS-to-the-new-disk-without-reinstalling/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2016/12/24/2016/2016-12-24-move-OS-to-the-new-disk-without-reinstalling/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>几年前700多大洋入的浦科特128G SSD 近来愈发觉得不够用，趁着今年双十一终于决定再入一块三星256G SSD，仍然是700多大洋。虽然并不喜欢三星MLC工艺，无奈这么多年过去接口升级换代，当年的mSATA也只有三星还在稳定出货价钱合适。这应该是小黑T420最后一次磁盘升级了。</p>
<p>用了这么多年的系统，装了无数大小软件，实在不想再重装系统，之前从HDD到SSD，使用分区助手的迁移系统功能，轻松完成转换。这次因为系统盘上有双系统，所以并不能直接用”系统迁移到SSD/HDD”，而是选了”扇区到扇区复制”，希望保留双系统配置。当然小黑只有一个mSATA接口，为了完成这次任务，又入了佳翼的mSATA移动硬盘盒。然后选择正确的磁盘，根据提示重启后开始复制，这个过程大概进行了1小时40分钟，因为小黑那个时代还只有USB2.0，接口速度比较慢只有150Mbps，所以可以算出120G*8/150Mbps = 1.8小时。<br><img src="/img/2016-12-24_161700.jpg" alt="JEYI"><br><img src="/img/2016-12-24_162431.png" alt="分区助手复制磁盘"></p>
<p>复制完成后，满怀希望地换上新的SSD，以为开机重启就焕发新生了，前面Clover引导都很正常，然后就碰到下面这个鬼画面。<br><img src="/img/2016-12-24_161500.jpg" alt="0xc000000e"></p>
<p>网上搜索都指向修复<code>\boot\BCD</code>文件，但是首先需要一张系统恢复DVD，而且更关键的是貌似需要重置MBR，而我的MBR已经配置了Clover，当初好不容易搞定三系统，轻易不想再动它。于是继续搜索，意识到系统认为硬件变动了，那体现在BCD里面，就只有分区GUID不同，为新分区重建一个entry应该就可以了。换回旧SSD启动电脑，这里用了EasyBCD来操作，其背后会调用bcdedit.exe来操作BCD文件。首先配置下EasyBCD编辑的BCD文件，然后重启程序让设置生效。这里直接指向了新SSD系统使用的BCD，但是安全起见，最好复制一份出来然后在上面编辑，最后再复制回去。<br><img src="/img/2016-12-24_165701.png" alt="设定BCD文件位置"><br>然后新建启动入口。<br><img src="/img/2016-12-24_155520.png" alt="新建启动项"><br>这里选择了新分区所在的盘符K。</p>
<p>然后用bcdedit.exe(可以在EasyBCD安装目录下找到)找到新建项目的GUID<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bcdedit <span class="string">/store</span> &lt;path_to_bcd&gt; <span class="string">/enum</span> all</span><br><span class="line">bcdedit <span class="string">/store</span> &lt;path_to_bcd&gt; <span class="string">/enum</span> all <span class="string">/v</span></span><br></pre></td></tr></table></figure></p>
<p>将盘符改回c盘，设置新建条目为默认启动项。<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /store &lt;path_to_bcd&gt; /<span class="builtin-name">set</span> &#123;bootmgr&#125;<span class="built_in"> default </span>&lt;new guid&gt;</span><br><span class="line">bcdedit /store &lt;path_to_bcd&gt; /<span class="builtin-name">set</span> &#123;default&#125; osdevice c:</span><br><span class="line">bcdedit /store &lt;path_to_bcd&gt; /<span class="builtin-name">set</span> &#123;default&#125; device c:</span><br></pre></td></tr></table></figure></p>
<p>因为换到新磁盘启动时，系统分区一般就是c盘。可能有人会疑问为什么新建条目时，不直接选c盘，我的理解是GUID是从分区算出来的，选c盘可能会算出旧分区的GUID，这与我们的要求不符。改完之后重启，还是失败，但是错误原因已经变了，是找不到启动程序winload，而不再是压根都找不到设备，看来猜测靠谱。<br><img src="/img/2016-12-24_161600.jpg" alt="0xc000000e again"></p>
<p>但是明明winload是不会丢的，系统找不到，可能跟多系统有关，引导程序错误地在一个分区搜索winload。继续搜索找到了解决之道，将启动分区从c:改成boot，意思是让引导程序在当前分区寻找winload。重启搞定。<br><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /store &lt;path_to_bcd&gt; /<span class="keyword">set</span> &#123;<span class="keyword">default</span>&#125; <span class="keyword">osdevice</span> <span class="keyword">boot</span></span><br><span class="line"><span class="keyword">bcdedit</span> /store &lt;path_to_bcd&gt; /<span class="keyword">set</span> &#123;<span class="keyword">default</span>&#125; <span class="keyword">device</span> <span class="keyword">boot</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2016/08/06/2016/2016-08-06-work-on-the-cloud-thoroughly/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/06/2016/2016-08-06-work-on-the-cloud-thoroughly/" itemprop="url">完全云端工作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-06T15:04:00+08:00">2016-08-06</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/06/2016/2016-08-06-work-on-the-cloud-thoroughly/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2016/08/06/2016/2016-08-06-work-on-the-cloud-thoroughly/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>随着工作环境的增多，工作内容的同步变得越来越麻烦。以前我们拿U盘拷或者网盘共享，现在进入的云时代，如果不考虑隐私问题，托管在云端不失为一个好办法。<br>目前初步计划完成代码部分的云托管，随后拓展到笔记，个人知识库，二进制资料等等。</p>
<ol>
<li><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3>github是首选，如果要托管私人项目，可以选择gitlab。</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2015/09/20/2015/2015-09-20-Design-Patterns-Decorator-AOP-in-Python-and-C-C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/09/20/2015/2015-09-20-Design-Patterns-Decorator-AOP-in-Python-and-C-C/" itemprop="url">设计模式之装饰器/面向切面编程在Python和C中的体现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-20T21:14:45+08:00">2015-09-20</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/09/20/2015/2015-09-20-Design-Patterns-Decorator-AOP-in-Python-and-C-C/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2015/09/20/2015/2015-09-20-Design-Patterns-Decorator-AOP-in-Python-and-C-C/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近学习到python中的装饰器有点意思，函数定义前面声明一句话，即可改变函数的部分行为。不同的声明，可以从不同方面改变函数的行为，就像一栋房子重新装修了下，就有了不同的风格。<br>小小的提炼却是大大的进步。<br>比如<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">(fn)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"hello, %s"</span> % fn.__name__</span><br><span class="line">        fn()</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"goodby, %s"</span> % fn.__name__</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@hello</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"i am foo"</span></span><br><span class="line"></span><br><span class="line">foo()</span><br></pre></td></tr></table></figure></p>
<p>运行后<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ python hello.py</span><br><span class="line">hello, foo</span><br><span class="line"><span class="selector-tag">i</span> am foo</span><br><span class="line">goodby, foo</span><br></pre></td></tr></table></figure></p>
<p>追究其本质，首先是因为在python中一切皆对象，函数也不例外，所以有了动态修改函数指向对象的机会，那么经过修饰器修饰后，foo其实已不是原来的foo，而是被包装过的：<code>foo = hello(foo)</code>，再次调用时，新的foo指向了包装后的新函数，从而包括了原来的foo功能和包装器的新功能。</p>
<blockquote>
<p>装饰器作为一种设计模式，在插入日志，性能测试，事务处理方面有着广泛应用。</p>
</blockquote>
<p>作为一个C起家的程序员，看完这些突然意识到，这样的模式其实在C实践中也有很多应用，比如上面插入日志的例子，在C中就是：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	print(<span class="string">"in foo: %d\n"</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>修饰下，插入日志。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _foo(<span class="keyword">int</span> x)</span><br><span class="line">&#123;</span><br><span class="line">	print(<span class="string">"in foo: %d\n"</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> foo(x)		\</span></span><br><span class="line">	<span class="keyword">do</span> &#123;			\</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"hello\n"</span>);	\</span><br><span class="line">		_foo(x);	\</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"goodbye\n"</span>);	\</span><br><span class="line">	&#125; <span class="keyword">while</span> (<span class="number">0</span>)</span><br></pre></td></tr></table></figure></p>
<p>更进一步，C语言中有种特殊的调试技巧：某个函数被广泛调用，我们想追踪这个函数在动态执行时，被哪些函数调用，以及传入的参数是什么名称。<br>最简单粗暴的方法就是找出所有调用的地方，前面插入跟踪代码，打印调用函数和参数。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_1	50</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_2	100</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"caller %s, argument ARG_1\n"</span>, __func__);</span><br><span class="line">	foo(ARG_1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"caller %s, argument ARG_2\n"</span>, __func__);</span><br><span class="line">	foo(ARG_2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>显然这样做既费时痛苦又无扩展性，如果想跟踪其它函数，还得再这样改一遍。<br>改进的做法就是用宏定义同名覆盖函数，然后加上调试信息。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _foo(<span class="keyword">int</span> x)</span><br><span class="line">&#123;</span><br><span class="line">	print(<span class="string">"in foo: %d\n"</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> foo(x)		\</span></span><br><span class="line">	<span class="keyword">do</span> &#123;			\</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"caller %s, argument %s\n"</span>, __func__, ##x);	\</span><br><span class="line">		_foo(x);	\</span><br><span class="line">	&#125; <span class="keyword">while</span> (<span class="number">0</span>)</span><br></pre></td></tr></table></figure></p>
<p>只需如此修改，其它所有调用foo的地方无需修改即可达到前述跟踪目的。这里面蕴含的思想其实跟修饰器是类似的：<code>通过修改原函数的指向，在原函数的基础上添加新功能</code>。</p>
<p>当然这里有三点区别：</p>
<ol>
<li>C实现的修饰是编译时修改，而python是运行时动态修改；</li>
<li>C函数的修饰器就是宏定义，而且需要修改原函数原型的名称，以防命名冲突；Python的修饰器是另一个函数，修饰后原函数被覆盖。</li>
<li>C函数被修饰后，并没有生成新的函数，而是在原来的函数调用处添加了一些语句，而python简单彻底，重新生成新的函数对象。</li>
</ol>
<p>参考文章：<br><a href="http://coolshell.cn/articles/11265.html" target="_blank" rel="noopener">coolshell的Python修饰器的函数式编程</a><br><a href="http://www.cnblogs.com/huxi/archive/2011/03/01/1967600.html" target="_blank" rel="noopener">Python装饰器与面向切面编程</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2015/09/12/2015/2015-09-12-Set-up-Peanut-Hull-for-Raspberry-Pi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/09/12/2015/2015-09-12-Set-up-Peanut-Hull-for-Raspberry-Pi/" itemprop="url">树莓派上配置动态域名解析Oray DDNS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-12T21:45:53+08:00">2015-09-12</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/09/12/2015/2015-09-12-Set-up-Peanut-Hull-for-Raspberry-Pi/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2015/09/12/2015/2015-09-12-Set-up-Peanut-Hull-for-Raspberry-Pi/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>raspberry pi玩到后来不可避免会玩上DDNS，即<a href="https://en.wikipedia.org/wiki/Dynamic_DNS" target="_blank" rel="noopener">动态域名解析</a>，众所周知拨号上网拿到的公网IP每次可能不一样，为了从公网访问拨号猫后面的内网PC，需要外部提供一个查询机制，即DDNS，在这个外部查询系统注册一个域名之后，内部再装一个客户端，里应外合，把拨号拿到的公网IP通知给公网上的查询系统。这样公网用户每次要访问内网的PC，首先到这个确定地址的公网查询注册的域名，然后转换成对应的IP，从而达到访问内网PC的目的。<br>关于如何在Raspberry Pi设置花生壳，官网已经有<a href="http://service.oray.com/question/2680.html" target="_blank" rel="noopener">介绍</a>。<br>需要注意的是运行oraynewph需要root权限。</p>
<p><strong>Update@2015-09-13</strong><br>花生壳的免费域名实在太不好用，第一次成功更新A记录后，不管后面拨号再怎么重换地址，花生壳系统的A记录和路由的WAN地址始终不一致，还不能手动改。考虑到使用的电信网络，应该不存在ISP NAT的情况，折腾数天不妥，怒弃之。。。<br><img src="/img/2015-09-13_174117.png" alt="死活不更新"><br>另外考虑到花生壳的免费域名，可能会被无聊人士盯上乱扫描，万一自家的路由器，树莓派等等有什么漏洞，城池难保。<del>折衷的办法就是自己麻烦一点，让rapsberry pi主动email报告IP。后面完善了回来补充</del>。鉴于ISP NAT的问题，WAN的IP也不是公网IP，这个方案也被否决了。<br><strong>Update@2015-09-14</strong><br>换了路由自带的花生壳客户端，同样的不一致问题，<del>只能归咎于免费域名的故意限制。。。尝试其他DDNS服务。。。</del><br><strong>Update@2015-09-14</strong><br>3322也一样，ip138也显示这个地址，看来真的是有ISP NAT。。。<br><strong>Update@2015-09-15</strong><br>对于ISP NAT，花生壳官网介绍有<a href="http://service.oray.com/question/136.html" target="_blank" rel="noopener">解决方案</a>，只要你升到专业服务:(<br>说实话这个解决方案只是重新选择了下接入线路，背后原理莫名其妙，貌似再没有其它家有类似的解决方案。<br>初步搜索了下，在有ISP NAT的情况下，如果自己用，VPN不失为一个靠谱的解决方案。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2015/09/12/2015/2015-09-12-Set-up-nginx-for-hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/09/12/2015/2015-09-12-Set-up-nginx-for-hexo/" itemprop="url">设置nginx运行Hexo生产的静态网站</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-12T11:00:36+08:00">2015-09-12</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/09/12/2015/2015-09-12-Set-up-nginx-for-hexo/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2015/09/12/2015/2015-09-12-Set-up-nginx-for-hexo/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>hexo基于nodejs实现，本质上都是V8引擎解释js语句执行，效率必然比不上本地代码。在raspberry pi资源这么有限的环境下，hexo server不是个好主意，那么以速度著称的nginx就是个必然选择。<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nginx</span><br><span class="line">sudo <span class="regexp">/etc/</span>init.d/nginx start</span><br><span class="line">sudo <span class="regexp">/usr/</span>sbin/update-rc.d -f nginx defaults</span><br><span class="line">sudo vi <span class="regexp">/etc/</span>nginx<span class="regexp">/sites-enabled/</span><span class="keyword">default</span></span><br></pre></td></tr></table></figure></p>
<p>找到server的配置，修改root目录<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">server</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    server_name localhost;</span><br><span class="line">    <span class="keyword">index</span> <span class="keyword">index</span>.html <span class="keyword">index</span>.htm;</span><br><span class="line">    root  /home/pi/hexo/<span class="keyword">public</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>修改完后别忘了让nginx重新读取配置<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="string">/etc/init.d/nginx</span> <span class="keyword">reload</span></span><br></pre></td></tr></table></figure></p>
<p>为了能根据blog源代码的改变及时更新public，可以让hexo在后台进行监视<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">generate</span> --watch</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/2015/09/12/2015/2015-09-12-Set-up-the-Hexo-on-Raspberry-Pi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/09/12/2015/2015-09-12-Set-up-the-Hexo-on-Raspberry-Pi/" itemprop="url">在树莓派上安装hexo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-12T09:01:19+08:00">2015-09-12</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/09/12/2015/2015-09-12-Set-up-the-Hexo-on-Raspberry-Pi/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/2015/09/12/2015/2015-09-12-Set-up-the-Hexo-on-Raspberry-Pi/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前烧录的Raspberry image已经自带了很多工具，其中包括git，但是hexo还不在里面。用<code>apt-get install nodejs</code>装了一个，版本非常老0.6.xx。想要更新到最新？没问题，官网直接为树莓派的老旧CPU编译好了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://nodejs.org/dist/latest/node-v4.0.0-linux-armv6l.tar.gz</span><br><span class="line">tar xf node-v4.0.0-linux-armv6l.tar.gz</span><br><span class="line">mv node-v4.0.0-linux-armv6l/ node</span><br><span class="line">mv node /usr/<span class="built_in">local</span>/</span><br><span class="line">chown -R pi.pi /usr/<span class="built_in">local</span>/node</span><br></pre></td></tr></table></figure></p>
<p>如果后面有更新版本，上面的版本号注意替换掉。<br>设置环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"PATH=<span class="variable">$PATH</span>:/usr/local/node/bin"</span> &gt;&gt; ~/.profile</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"export PATH"</span> &gt;&gt; ~/.profile</span><br><span class="line"><span class="built_in">source</span> ~/.profile</span><br><span class="line">node -v  <span class="comment">#检查路径是否设置正确</span></span><br></pre></td></tr></table></figure></p>
<p>安装hexo<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo</span><br><span class="line">mkdir -p /home/hexo</span><br><span class="line"><span class="built_in">cd</span> /home/hexo</span><br><span class="line">hexo init <span class="comment">#添加一个博客站点</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></p>
<p>clone blog hexo源文件到本地<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b blog_code https://github.com/pansila/pansila.github.io.git</span><br></pre></td></tr></table></figure></p>
<p>执行后会将git上blog_code分支的文件放到pansila.github.io目录，这个目录放置了hexo源代码（网页静态文件放在了master branch），因为之前在hexo目录建立hexo环境，所以要让hexo在git的文件上跑起来，需要将pansila.github.io目录下的所有东西复制到hexo目录<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp pansila<span class="selector-class">.github</span><span class="selector-class">.io</span> .. -R</span><br><span class="line">rm pansila<span class="selector-class">.github</span><span class="selector-class">.io</span> -R</span><br></pre></td></tr></table></figure></p>
<p>试了下速度，rapberry pi上跑hexo性能不如乐观。。。<br>同样的文件raspberry pi上，load files要24s，generate files要23s<br>PC上load files只要1s，generate files 580ms</p>
<p>参考文章：<a href="http://rpi.linux48.com/Hexo.html" target="_blank" rel="noopener">树莓派安装node.js来跑Hexo静态博客</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Pansila</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate"> 
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pansila</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.6</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.6"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.6"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.6"></script>



  



	





  





  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'qBTseCeEXIm7y4BLwe05EVy9-gzGzoHsz',
        appKey: 'Vo7kIJagaWoBbHKtppisGPj0',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  

  

  
  

  

  

  

  

</body>
</html>
