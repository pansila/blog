<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.6" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.6">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.6" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.0.6',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Fantasy and Fiction">
<meta property="og:url" content="http://pansila.github.io/page/2/index.html">
<meta property="og:site_name" content="Fantasy and Fiction">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fantasy and Fiction">






  <link rel="canonical" href="http://pansila.github.io/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Fantasy and Fiction</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Fantasy and Fiction</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
</li>

      

      
    </ul>
  

  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/ada4fde5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/ada4fde5/" itemprop="url">在树莓派上安装hexo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-12T09:01:19+08:00">2015-09-12</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/ada4fde5/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/ada4fde5/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/ada4fde5/" class="leancloud_visitors" data-flag-title="在树莓派上安装hexo">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前烧录的Raspberry image已经自带了很多工具，其中包括git，但是hexo还不在里面。用<code>apt-get install nodejs</code>装了一个，版本非常老0.6.xx。想要更新到最新？没问题，官网直接为树莓派的老旧CPU编译好了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget http://nodejs.org/dist/latest/node-v4.0.0-linux-armv6l.tar.gz</span><br><span class="line">tar xf node-v4.0.0-linux-armv6l.tar.gz</span><br><span class="line">mv node-v4.0.0-linux-armv6l/ node</span><br><span class="line">mv node /usr/<span class="built_in">local</span>/</span><br><span class="line">chown -R pi.pi /usr/<span class="built_in">local</span>/node</span><br></pre></td></tr></table></figure></p>
<p>如果后面有更新版本，上面的版本号注意替换掉。<br>设置环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"PATH=<span class="variable">$PATH</span>:/usr/local/node/bin"</span> &gt;&gt; ~/.profile</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"export PATH"</span> &gt;&gt; ~/.profile</span><br><span class="line"><span class="built_in">source</span> ~/.profile</span><br><span class="line">node -v  <span class="comment">#检查路径是否设置正确</span></span><br></pre></td></tr></table></figure></p>
<p>安装hexo<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo</span><br><span class="line">mkdir -p /home/hexo</span><br><span class="line"><span class="built_in">cd</span> /home/hexo</span><br><span class="line">hexo init <span class="comment">#添加一个博客站点</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></p>
<p>clone blog hexo源文件到本地<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b blog_code https://github.com/pansila/pansila.github.io.git</span><br></pre></td></tr></table></figure></p>
<p>执行后会将git上blog_code分支的文件放到pansila.github.io目录，这个目录放置了hexo源代码（网页静态文件放在了master branch），因为之前在hexo目录建立hexo环境，所以要让hexo在git的文件上跑起来，需要将pansila.github.io目录下的所有东西复制到hexo目录<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp pansila<span class="selector-class">.github</span><span class="selector-class">.io</span> .. -R</span><br><span class="line">rm pansila<span class="selector-class">.github</span><span class="selector-class">.io</span> -R</span><br></pre></td></tr></table></figure></p>
<p>试了下速度，rapberry pi上跑hexo性能不如乐观。。。<br>同样的文件raspberry pi上，load files要24s，generate files要23s<br>PC上load files只要1s，generate files 580ms</p>
<p>参考文章：<a href="http://rpi.linux48.com/Hexo.html" target="_blank" rel="noopener">树莓派安装node.js来跑Hexo静态博客</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/a7f85ddf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/a7f85ddf/" itemprop="url">New Toy - SanDisk Ultra 16G Class10 UHS-I</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-12T04:10:32+08:00">2015-09-12</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/a7f85ddf/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/a7f85ddf/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/a7f85ddf/" class="leancloud_visitors" data-flag-title="New Toy - SanDisk Ultra 16G Class10 UHS-I">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>自从iPhone开启自带Flash Rom风潮以来，外置TF卡在手机上越来越不受待见，这次为了把吃灰多年的Raspberry Pi拿出来晒晒太阳，决心新入手一块TF卡。<br>吐槽下京东可能除了物流价格上真心没啥优势。。。<br>先来一张大头照<br><img src="/img/20150912041903.jpg" alt="美照"><br>然后照例验证正品，没问题。<br>测试读写速度<br><img src="/img/2015-09-12_035642.png" alt="ATTO Disk BenchMark"><br>最大速度，读45MB/s，写17MB/s左右。比官网号称48MB/s稍显乏力。。。<br>写入Raspberry Pi image<br><img src="/img/2015-09-12_040514.png" alt="Win32 Disk Imager"><br>写入速度差不多在15~16MB/s。</p>
<p>附上对比测试，金士顿未知Class卡<br><img src="/img/20150912062844.jpg" alt="Kinston unknown TF"><br>速度测试<br><img src="/img/2015-09-12_050307.png" alt="ATTO Disk BenchMark"><br>看起来应该也是Class 10级别的卡。<br><del>Raspberry Pi板载速度测试敬请期待。。。</del><br>接上文接着测试Raspberry Pi上，方法简单粗暴，就是dd拷贝测试：<br>写<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="attribute">if</span>=/dev/zero <span class="attribute">of</span>=~/test.tmp <span class="attribute">bs</span>=500K <span class="attribute">count</span>=1024</span><br><span class="line">524288000 bytes (524 MB) copied, 36.7958 s, 14.2 MB/s</span><br></pre></td></tr></table></figure></p>
<p>读<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="attribute">if</span>=~/test.tmp <span class="attribute">of</span>=/dev/null <span class="attribute">bs</span>=500K <span class="attribute">count</span>=1024</span><br><span class="line">524288000 bytes (524 MB) copied, 28.128 s, 18.6 MB/s</span><br></pre></td></tr></table></figure></p>
<p>这个数据与官方同款测试基本一致（详见下方链接），猜测受限于raspberry pi的SDIO总线速度，读写速度均有一定程度下降。</p>
<p><a href="http://elinux.org/RPi_SD_cards#SD_card_performance" target="_blank" rel="noopener">树莓派SD卡参考速度</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/f2e9d307/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/f2e9d307/" itemprop="url">cache exercises - Ex. 1 memory read optimization</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-10T13:02:37+08:00">2015-09-10</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/f2e9d307/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/f2e9d307/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/f2e9d307/" class="leancloud_visitors" data-flag-title="cache exercises - Ex. 1 memory read optimization">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Cache对于现代处理器提升性能有多重要就不多说了，最近看到这方面的练习，正好来实践下。<br>原文来自伯乐在线请猛击<a href="http://blog.jobbole.com/89759/" target="_blank" rel="noopener">这里</a><br>第一个例子解释cache一次从memory读取的大小，这是可能与cache line不一致的，具体多少可以通过统计得出。<br>原文使用了C#例子，正好最近学习python，这里来模拟下。</p>
<h3 id="1-基于list的测试"><a href="#1-基于list的测试" class="headerlink" title="1. 基于list的测试"></a>1. 基于list的测试</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">buf_len = <span class="number">64</span>*<span class="number">1024</span>*<span class="number">1024</span></span><br><span class="line">buffer = [<span class="number">0</span>] * buf_len</span><br><span class="line"></span><br><span class="line"><span class="comment"># update @2015-09-20</span></span><br><span class="line"><span class="comment">#def calc_at_every(step):</span></span><br><span class="line"><span class="comment">#	i = 0</span></span><br><span class="line"><span class="comment">#	while i &lt; buf_len:</span></span><br><span class="line"><span class="comment">#		buffer[i] *= 3</span></span><br><span class="line"><span class="comment">#		i += step</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_at_every</span><span class="params">(step)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, buf_len, step):</span><br><span class="line">		buffer[i] *= <span class="number">3</span></span><br><span class="line">		</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="keyword">from</span> timeit <span class="keyword">import</span> Timer</span><br><span class="line">	results = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">33</span>):</span><br><span class="line">		<span class="comment">#print "test starts for step %d" % i</span></span><br><span class="line">		t = Timer(<span class="string">"calc_at_every(%d)"</span> % i, <span class="string">"from __main__ import calc_at_every"</span>)</span><br><span class="line">		<span class="comment">#print t.timeit(1)</span></span><br><span class="line">		results.append(t.timeit(<span class="number">1</span>))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">	plt.plot(range(<span class="number">1</span>, <span class="number">33</span>), results)</span><br><span class="line">	plt.ylabel(<span class="string">'runtime per step size'</span>)</span><br><span class="line">	plt.xlabel(<span class="string">'set size'</span>)</span><br><span class="line">	plt.show()</span><br></pre></td></tr></table></figure>
<p>最直接的模仿就是list，可惜结果差3个数量级，看下图：<br><img src="/img/2015-09-10_130439.png" alt="list test"><br>步长为1时，遍历一遍需要12秒之多，例子中是80ms，大家感受下，cache肯定没有发挥作用。事实上随着step加倍，运行时间减半，完美的指数函数，完全忽视cache。。。<br>事实上python中list跟C/C++中的array并不一样，是一个包装起来的行为类似array的对象，其占用的size远远超过元素本身之和。<br><code>&gt;&gt;&gt; sys.getsizeof([])</code><br><code>64</code><br>这里其实已经做过优化，并没有使用<code>for ... in ...</code>这样的pythonic遍历方式，因为产生一个索引list会占用同样多的memory，而且也有memory read的cache问题。难道用python做性能测试就是个杯具。。。<br><strong>update @2015-09-20</strong><br>xrange正是为这样的迭代所优化，它不会实际产生一个遍历list，而是按需生成数据，因此内存效率和性能都大有改善。PS：range在python3中升级成为<a href="https://wiki.python.org/moin/Generators" target="_blank" rel="noopener">generator</a><br><img src="/img/2015-09-20_103325.png" alt="list test by xrange"><br>可以看到1步遍历提高了约33%的性能，遍历一遍需要大约8秒(缩短4秒)，虽然离cache的结果还差得远，但就遍历来说是个很好的优化。</p>
<h3 id="2-基于array的测试"><a href="#2-基于array的测试" class="headerlink" title="2. 基于array的测试"></a>2. 基于array的测试</h3><p>既然list不够快，那换能够直接接触memory的array。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> array <span class="keyword">import</span> array</span><br><span class="line"></span><br><span class="line">buf_len = <span class="number">64</span>*<span class="number">1024</span>*<span class="number">1024</span></span><br><span class="line">buf = [<span class="number">0</span>] * buf_len</span><br><span class="line">buffer = array(<span class="string">'i'</span>, buf)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_at_every</span><span class="params">(step)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, buf_len, step):</span><br><span class="line">		buffer[i] *= <span class="number">3</span></span><br><span class="line">		</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="keyword">from</span> timeit <span class="keyword">import</span> Timer</span><br><span class="line">	results = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">33</span>):</span><br><span class="line">		<span class="comment">#print "test starts for step %d" % i</span></span><br><span class="line">		t = Timer(<span class="string">"calc_at_every(%d)"</span> % i, <span class="string">"from __main__ import calc_at_every"</span>)</span><br><span class="line">		<span class="comment">#print t.timeit(1)</span></span><br><span class="line">		results.append(t.timeit(<span class="number">1</span>))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">	plt.plot(range(<span class="number">1</span>, <span class="number">33</span>), results)</span><br><span class="line">	plt.ylabel(<span class="string">'runtime per step size'</span>)</span><br><span class="line">	plt.xlabel(<span class="string">'set size'</span>)</span><br><span class="line">	plt.show()</span><br></pre></td></tr></table></figure></p>
<p>结果更差。。。<br><img src="/img/2015-09-20_104140.png" alt="Array test by xrange"></p>
<h3 id="3-基于numpy-array的测试"><a href="#3-基于numpy-array的测试" class="headerlink" title="3. 基于numpy.array的测试"></a>3. 基于numpy.array的测试</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> array <span class="keyword">import</span> array</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">buf_len = <span class="number">64</span>*<span class="number">1024</span>*<span class="number">1024</span></span><br><span class="line">buf = [<span class="number">0</span>] * buf_len</span><br><span class="line">buffer = np.array(buf)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_at_every</span><span class="params">(step)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, buf_len, step):</span><br><span class="line">		buffer[i] *= <span class="number">3</span></span><br><span class="line">		</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="keyword">from</span> timeit <span class="keyword">import</span> Timer</span><br><span class="line">	results = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">33</span>):</span><br><span class="line">		<span class="comment">#print "test starts for step %d" % i</span></span><br><span class="line">		t = Timer(<span class="string">"calc_at_every(%d)"</span> % i, <span class="string">"from __main__ import calc_at_every"</span>)</span><br><span class="line">		<span class="comment">#print t.timeit(1)</span></span><br><span class="line">		results.append(t.timeit(<span class="number">1</span>))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">	plt.plot(range(<span class="number">1</span>, <span class="number">33</span>), results)</span><br><span class="line">	plt.ylabel(<span class="string">'runtime per step size'</span>)</span><br><span class="line">	plt.xlabel(<span class="string">'set size'</span>)</span><br><span class="line">	plt.show()</span><br></pre></td></tr></table></figure>
<p>惨不忍睹。。。</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="/img/2015-09-20_104818.png" alt="numpy.array test"></h2><p><strong>to be continued</strong></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/90e900ea/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/90e900ea/" itemprop="url">调整MAC OS X系统所在分区大小</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-05T02:58:20+08:00">2015-09-05</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/90e900ea/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/90e900ea/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/90e900ea/" class="leancloud_visitors" data-flag-title="调整MAC OS X系统所在分区大小">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开始安装Yosemite时，划分的分区过小，安装Xcode和IOS SDK时磁盘已经不够。作为爱偷懒的程序员，自然是能不重新安装最好不重装。</p>
<p>第一个想到的办法是Windows时代常用的Ghost。首先新划分一个合适大小的分区，格式不格式化无所谓，设置分区为激活状态。这里推荐分区助手，无损调节分区大小。<br>然后USB启动到PE，Ghost搬移partition，全程无压力。完成后启动新的Yosemite分区，发现分区大小也复制了过来。此法不通。</p>
<p>很快发现，Yosemite自带有Disk Utility，里面有Restore功能，专业系统搬移！Apple简直是太有预见性！<br>所以只要把原来的分区内容restore到一个更大的分区，就等于调节了分区大小。<br>不过要搬移的disk在Yosemite启动后就不能操作了，所以要从Yosemite的安装盘启动，里面也有这个工具。而且速度比Ghost还要快的多，3分钟搞定。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/90b97191/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/90b97191/" itemprop="url">被GRUB2破坏MBR后Yosemite的恢复</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-05T01:45:14+08:00">2015-09-05</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/90b97191/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/90b97191/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/90b97191/" class="leancloud_visitors" data-flag-title="被GRUB2破坏MBR后Yosemite的恢复">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前已经成功安装了Yosemite到Thinkpad T420上，然而不幸的是，楼主手贱在玩Ubuntu 14.04时把grub2安装到了所有硬盘上。<br>不得不吐槽Linux系统桌面软件不如Windows成熟，这么重要的操作，Ubuntu自带的这个grub2配置GUI程序，在应用修改时居然没有一声提示，所有tab下的设置都统统设了下去。欲哭无泪。</p>
<p>由于之前已经成功安装Yosemite，而Grub2理论上只会破坏MBR以及MBR到VBR之间的数据，所以只要恢复这部分数据就可以了。<br>那么原来的这部分数据是什么呢，是Yosemite自己的bootloader，由于楼主之前用Multibeast安装了Chimera bootloader，所以首先要找到这个bootloader的boot0数据，即MBR数据。</p>
<p>有两种办法可以拿到这个数据：</p>
<ol>
<li><p>找到相应版本的Chimera pkg，这个文件可以用解压缩软件打开，在路径<code>Chimera 4.1.0.pkg\chimeraV41.pkg\Payload\Payload~\.\usr\standalone\i386\</code><br>下可以看到有四个文件：<code>boot</code>，<code>boot0</code>，<code>boot0md</code>，<code>boot1h</code>，boot是存放于HFS文件系统下的Chimera主体程序，boot0存放于MBR，boot1h存放于VBR，这几个文件的关系有兴趣的可以看<a href="https://en.wikipedia.org/wiki/GNU_GRUB" target="_blank" rel="noopener">GRUB的维基介绍</a>，原理一样。</p>
</li>
<li><p>另一个地方就在Yosemite系统里面，<code>/usr/standalone/i386</code>，里面也有这几个文件。</p>
</li>
</ol>
<p>找到这几个文件后，就可以动手实施恢复。<strong>以下高能，模仿慎重</strong><br>首先要独立于要操作的硬盘所在的系统进行操作，比如可以用USB盘启动PE，或者Yosemite的安装盘，或者其它硬盘上的系统。否则会提示无法操作成功，目标硬盘被占用。<br>楼主使用其他硬盘上的Ubuntu操作，使用最简单的dd指令即可恢复。<br><code>sudo dd if=/media/username/bakup/boot0 of=/dev/sdc bs=440 count=1</code><br>里面的路径注意替换成自己的，440字节是为了避免把分区表覆盖，同时还要保留分区表前面6个字节的磁盘签名。关于MBR可以猛戳<a href="https://en.wikipedia.org/wiki/Master_boot_record" target="_blank" rel="noopener">MBR维基</a>。<br>最后，注意要把活动分区设为Yosemite所在的分区，这个boot0，似乎只认活动分区，不认HFS分区。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/b03ccf68/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/b03ccf68/" itemprop="url">fbinst/fbinstTool no menu问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-30T11:30:40+08:00">2015-08-30</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/b03ccf68/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/b03ccf68/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/b03ccf68/" class="leancloud_visitors" data-flag-title="fbinst/fbinstTool no menu问题">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>安利下，fbinst是个万能启动盘制作工具，能引导多种类型系统，网管必备。。。<br>使用fbinstTool制作启动盘时，碰到无法启动引导程序问题，提示”no menu”信息。</p>
<p><img src="/img/2015-08-30_113215.png" alt="错误提示"></p>
<p>google搜索没有结果，只好尝试自己排查问题。首先fbinst是个<a href="http://download.gna.org/grubutil/" target="_blank" rel="noopener">开源程序</a>，因此最简单办法就是看代码为何出现如此错误。<br>搜索no menu，可以看到相关代码在fbmbr.S<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">	movb	$FBM_TYPE_MENU, %cl</span><br><span class="line">	<span class="keyword">call</span>	find_first_item</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>:</span><br><span class="line">	<span class="keyword">jc</span>	1f</span><br><span class="line">	subb	<span class="number">$1</span>, %bl</span><br><span class="line">	<span class="keyword">jc</span>	boot_item</span><br><span class="line">	<span class="keyword">call</span>	find_next_item</span><br><span class="line">	<span class="keyword">jmp</span>	<span class="number">1b</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>:</span><br><span class="line">	movw	$<span class="built_in">ABS</span>(err_no_menu), %si</span><br><span class="line">	<span class="keyword">jmp</span>	fail</span><br><span class="line">	</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line"><span class="symbol">err_no_menu:</span></span><br><span class="line"><span class="meta">	.ascii</span>	<span class="string">"no menu\0"</span></span><br></pre></td></tr></table></figure></p>
<p>可以看到是在查找FBM_TYPE_MENU这个类型的数据时失败所致，继续回溯调用路径，可以看到这部分代码在parse_menu label下，而调用parse_menu的地方只有一个<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">movw	$<span class="built_in">ABS</span>(menu_file), %si</span><br><span class="line">pushw	%si</span><br><span class="line"><span class="keyword">call</span>	check_file</span><br><span class="line">popw	%si</span><br><span class="line"><span class="keyword">jc</span>	1f</span><br><span class="line"><span class="keyword">call</span>	load_file</span><br><span class="line"><span class="keyword">jmp</span>	parse_menu</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="symbol">menu_file:</span></span><br><span class="line"><span class="meta">.ascii</span>	FB_MENU_FILE <span class="string">"\0"</span></span><br></pre></td></tr></table></figure></p>
<p>FB_MENU_FILE就是要查找的目标，看看它是什么，搜索可以发现其定义在fbinst.h，<code>#define FB_MENU_FILE        &quot;fb.cfg&quot;</code><br>所以问题是这个文件找不到，这个文件其实是有的，它就是fbinst菜单</p>
<p><img src="/img/2015-08-30_122425.png" alt="fbinst菜单"><br>原来默认启动项指向了一个不存在的条目，这才想起来因为之前配置过其它引导条目，后又删除忘记恢复default所致。。。<br>修改后，正常启动。<br><img src="/img/2015-08-30_113423.png" alt="正常启动"></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/824aa96e/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/824aa96e/" itemprop="url">Install clover on USB stick</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-29T17:46:56+08:00">2015-08-29</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/824aa96e/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/824aa96e/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/824aa96e/" class="leancloud_visitors" data-flag-title="Install clover on USB stick">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>clover支持UEFI和legacy两种BIOS启动，并且可以随意搭配GPT分区和MBR分区安装的系统，但是需要调教参数。<br>首先有一些概念要区别。<br>We can boot from a UEFI system and install Windows in UEFI\GPT mode, or boot in BIOS\CSM mode and install Windows in MBR mode.</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://pansila.github.io/posts/733704b8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pansila">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Fantasy and Fiction">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/733704b8/" itemprop="url">Blog架设总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-22T21:23:19+08:00">2015-08-22</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/733704b8/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments:</span> <span class="post-comments-count valine-comment-count" data-xid="/posts/733704b8/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/733704b8/" class="leancloud_visitors" data-flag-title="Blog架设总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Views:</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>虽然有各种教程，折腾了一天才算能用起来，总结下:</p>
<ul>
<li>repository必须是以如下的形式命名:<blockquote>
<p>[<strong>用户名</strong>].github.io</p>
</blockquote>
</li>
</ul>
<p>比如abc就是abc.github.io<br>branch名字必须是master，对于子目录下的站点，必须是gh-pages  </p>
<ul>
<li>hexo generate生成的文件默认在public里面，需要复制到外面与_config.yaml同目录下。</li>
<li>开始不知道在哪写文章，后来发现其实接着生成的md文件内容往下写就行了。。。</li>
<li>采用markdown写作，所见即所得 </li>
</ul>
<p>相关引用：<br><a href="https://www.zybuluo.com/mdeditor" target="_blank" rel="noopener">Cmd Markdown</a><br><a href="http://wowubuntu.com/markdown" target="_blank" rel="noopener">Markdown简明介绍</a><br><a href="https://github.com/coapp/coapp.org/blob/master/src/dynamic/reference/garrett-flavored-markdown.html.md#precode" target="_blank" rel="noopener">Markdown代码块支持的语言</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Pansila</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate"> 
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pansila</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.0.6</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.6"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.0.6"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.6"></script>



  



	





  





  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'qBTseCeEXIm7y4BLwe05EVy9-gzGzoHsz',
        appKey: 'Vo7kIJagaWoBbHKtppisGPj0',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("qBTseCeEXIm7y4BLwe05EVy9-gzGzoHsz", "Vo7kIJagaWoBbHKtppisGPj0");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            
            counter.save(null, {
              success: function(counter) {
                
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.get('time'));
                
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            
              var newcounter = new Counter();
              /* Set ACL */
              var acl = new AV.ACL();
              acl.setPublicReadAccess(true);
              acl.setPublicWriteAccess(true);
              newcounter.setACL(acl);
              /* End Set ACL */
              newcounter.set("title", title);
              newcounter.set("url", url);
              newcounter.set("time", 1);
              newcounter.save(null, {
                success: function(newcounter) {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
                },
                error: function(newcounter, error) {
                  console.log('Failed to create');
                }
              });
            
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  
  

  

  

  

  

</body>
</html>
